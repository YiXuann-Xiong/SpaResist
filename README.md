# SpaResist
SpaResist is a spatial transcriptomics pipeline for deconvolution, cancer cell state characterization, and drug resistance mechanism discovery.

# Spatial transcriptomics analysis pipeline (Visium HD) — RCTD + Harmony + clustering + DE + KEGG

This repository contains an end-to-end R pipeline for analyzing high-resolution spatial transcriptomics (10x Visium HD) data, including:
1) cell type deconvolution with **RCTD** using a scRNA-seq reference,
2) selection of **tumor-dominant** spots based on RCTD top-1 prediction,
3) batch correction using **Harmony** (Seurat v5 `HarmonyIntegration`),
4) clustering, marker detection, paired subset differential expression,
5) KEGG enrichment analysis.

The code is organized as a single script designed for transparency and reproducibility for peer review.

---

## Data sources

- **Spatial transcriptomics (Visium HD)**: GEO accession **GSE315639**  
  https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE315639

- **scRNA-seq reference for deconvolution (RCTD)**: GEO accession **GSE131907**  
  (used as the single-cell transcriptomic reference dataset for RCTD)

---

## Contents

- `analysis_pipeline.R`  
  Main pipeline script (RCTD → tumor spots → Harmony → clustering → DE → KEGG).
- `result/`  
  Output folder automatically generated by the script.
  - `all_markers.csv`  
  - `markers_S1320641_S1492809_1_vs_0.csv`  
  - `kegg_S1320641_S1492809_1_vs_0_up_markers.csv`  
  - `sessionInfo.txt`  

> Output filenames are configurable at the top of the script.

---

## Requirements

### R
- R >= 4.2 is recommended

### R packages
The pipeline uses the following R packages:
- `Seurat`
- `SeuratObject` 
- `harmony`
- `spacexr`
- `SpatialExperiment`, `SummarizedExperiment`
- `arrow` (for reading `.parquet`)
- `clusterProfiler`, `org.Hs.eg.db`

The specific version can be found in the sessionInfo.txt file.

## Contact

For questions about the analysis or to request the processed objects, please contact the corresponding author(s) Yi-Xuan Xiong at xyxuan@hunnu.edu.cn.
